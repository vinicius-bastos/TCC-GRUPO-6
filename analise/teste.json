tenho o arquivo seguinte que está trasendo uma lista de JSON como deixei o exemplo embaixo:

em um novo arquivo, me de um codigo que vai criar uma pasta "subscribed_wanna_cry" no bucket call-alien-vault-tcc-dev-main-pulses 
e vai chamar o método get_all_items
e inserir cada json da lista que retornar na pasta criada

arquivo extract_data.py:

import boto3
from dynamodb_json import json_util as json

def scan(params):
    try:
        dynamodb_client = boto3.client('dynamodb')
        result = dynamodb_client.scan(**params)
        # result_treated = json.loads(result)
        result = result['Items']
        result = json.loads(result)
        return result
    except Exception as e:
        raise e


def get_all_items(table, filter_expression=None):
    try:
        items = []
        last_evaluated_key = None
        cont = 0

        while True:
            cont = cont + 1
            scan_filter_option = {}

            if last_evaluated_key:
                scan_filter_option['ExclusiveStartKey'] = last_evaluated_key
            
            if filter_expression:
                scan_filter_option['FilterExpression'] = filter_expression

            result = scan({
                'TableName': table,
                **scan_filter_option
            })

            items.extend(result['Items'])

            if cont == 1:
              break

            if 'LastEvaluatedKey' in result:
                last_evaluated_key = result['LastEvaluatedKey']
            else:
                break
        # print(items)
        return items
    except Exception as e:
        raise e


exemplo da lista de JSON que vem do extract_data.py

[
  {
    "previous": "https: //otx.alienvault.com/api/v1/pulses/subscribed?page=24164",
    "prefetch_pulse_ids": False,
    "t3": 2.074805736541748,
    "count": 120824,
    "t": 0,
    "next": None,
    "results": [
      {
        "author_name": "AlienVault",
        "malware_families": [],
        "more_indicators": False,
        "references": [
          "http://blog.trendmicro.com/trendlabs-security-intelligence/trend-micro-discovers-new-adobe-flash-zero-day-exploit-used-in-malvertisements/"
        ],
        "targeted_countries": [],
        "created": datetime.datetime(2015,
        2,
        3,
        18,
        6,
        50,
        550000),
        "description": "",
        "indicators": [
          {
            "indicator": "retilio.com",
            "is_active": 1,
            "role": None,
            "created": "2015-02-03T18:06:51",
            "description": "",
            "expiration": None,
            "id": 1124,
            "type": "domain",
            "title": "",
            "content": ""
          }
        ],
        "extract_source": [],
        "adversary": None,
        "revision": 1,
        "tags": [],
        "public": 1,
        "industries": [],
        "name": "The Connections Between MiniDuke, CosmicDuke and OnionDuke",
        "modified": datetime.datetime(2015,
        1,
        14,
        18,
        8,
        13,
        678000),
        "tlp": "green",
        "attack_ids": [],
        "id": "54b6b08d11d4080471a1a38e"
      }
    ],
    "id": "a5eebe85-42cf-4da4-877c-4601589726a3",
    "t2": 2.6543893814086914
  }
]